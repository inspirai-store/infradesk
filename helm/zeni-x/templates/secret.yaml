{{- if and .Values.secret.enabled .Values.secret.create }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "zeni-x.fullname" . }}-secrets
  namespace: {{ .Values.namespace.name }}
  labels:
    {{- include "zeni-x.labels" . | nindent 4 }}
type: Opaque
data:
  {{- range $key, $value := .Values.secret.data }}
  {{ $key }}: {{ $value | b64enc }}
  {{- end }}
{{- end }}

{{- /* 注意：生产环境建议使用外部 Secret 管理系统（如 Kubernetes Secrets、Vault、Sealed Secrets 等）*/}}
{{- /* 示例：使用 Sealed Secrets 或 External Secrets Operator */}}
{{- /*
# 使用 External Secrets Operator 引用 AWS Secrets Manager
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: {{ include "zeni-x.fullname" . }}-external-secrets
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-secrets-manager
    kind: SecretStore
  target:
    name: {{ include "zeni-x.fullname" . }}-secrets
  data:
    - secretKey: MYSQL_ROOT_PASSWORD
      remoteRef:
        key: prod/zeni-x/mysql-password
*/}}
